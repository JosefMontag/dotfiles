#!/bin/sh
# volume.sh — PipeWire + Font Awesome icons (Inconsolata Nerd Font)

# Example outputs:
#   Volume: 0.52
#   Volume: 0.30 [MUTED]
line="$(wpctl get-volume @DEFAULT_AUDIO_SINK@ 2>/dev/null)" || exit 0

case "$line" in
  *"[MUTED]"*)
    printf " Off"
    exit 0
    ;;
esac

# Extract fractional volume (0.00–1.00) and convert to percent
frac=$(printf "%s" "$line" | awk '{print $2}')
# safety: strip anything non-numeric/dot
frac=$(printf "%s" "$frac" | tr -cd '0-9.')
[ -z "$frac" ] && exit 0

# Multiply by 100 and round
vol=$(awk -v f="$frac" 'BEGIN{printf("%d", (f*100)+0.5)}')

if   [ "$vol" -ge 100 ]; then
  icon="  ${vol}%"
elif   [ "$vol" -ge 71 ]; then
  icon="  ${vol}%"
elif [ "$vol" -ge 31 ]; then
  icon="  ${vol}%"
elif [ "$vol" -ge 1  ]; then
  icon="  ${vol}%"
else
  icon=""
fi

printf "%s" "$icon"
