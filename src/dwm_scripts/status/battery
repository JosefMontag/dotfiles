#!/bin/sh

# Read and sanitize
capacity=$(tr -d '[:space:]' < /sys/class/power_supply/BAT0/capacity) || exit 0
status=$(tr -d '[:cntrl:]' < /sys/class/power_supply/BAT0/status)

# Choose a battery glyph by capacity (ordered low→high)
bat_icon() {
  c=$1
  if   [ "$c" -le 5  ]; then printf "!"
  elif [ "$c" -le 10 ]; then printf ""
  elif [ "$c" -le 30 ]; then printf ""
  elif [ "$c" -le 60 ]; then printf ""
  elif [ "$c" -le 85 ]; then printf ""
  else                      printf ""
  fi
}

bicon=$(bat_icon "$capacity")

# Charging/AC status
# Possible values: Charging, Discharging, Full, Not charging, Unknown
case "$status" in
  Discharging) icon="$bicon" ;;
  Charging)    icon=" $bicon" ;;
  Full)        icon=" " ;;
  *)           icon="$bicon" ;;  # Not charging / Unknown
esac

# Print icon + percentage
printf "%s %s%%" "$icon" "$capacity"
